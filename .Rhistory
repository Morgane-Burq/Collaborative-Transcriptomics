genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Ligne,Colonne,nseg = c(1,5)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ PSANOVA(Ligne,Colonne,nseg = c(1,5)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
AIC_BIC <- function (data,X){
A <- as.data.frame(matrix(ncol=5))
colnames(A)<-c("X","i","j","AIC","BIC")
df<-data %>%
dplyr::select("Structuration_design","poids_graine","plante_genotype","voisin","Bloc_M","Ligne","Colonne","L","C",X)
colnames(df)<-c("Structuration_design","poids_graine","plante_genotype","voisin","Bloc_M","Ligne","Colonne","L","C","X")
for (i in (1:18)){
for(j in (1:15)){
print(i)
print(j)
mod <- mmer(X ~ Structuration_design
+ poids_graine
+ Bloc_M
+ plante_genotype
+ voisin,
random = ~ spl2Da(Ligne,Colonne,nseg = c(i,j)),
rcov = ~units,
data=df)
B<-c(X,i,j,mod$AIC,mod$BIC)
A<-rbind(A,B)
}
}
return (A[-1,])
}
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine ,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin ,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
random = ~  C + L,
data = data[-outlier,])
spats_f
plot(spats_f)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design,
random = ~  C + L,
data = data)
View(data)
View(data)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
plot(spats_f)
View(data)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
plot(spats_f)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
View(data)
table(data)
table(data$plante_genotype)
table(data$plante_genotype:voisin)
table(data$plante_genotype,data$voisin)
View(data)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-(outlier+235),])
data[-(outlier+235),]
View(data)
data[data$plante_genotype == 395 & data$voisin == 265]
data[data$plante_genotype == 395 & data$voisin == 235]
data[data$plante_genotype == 395 & data$voisin == 235]
data[data$plante_genotype == 395 & data$voisin == 235]
data[data$plante_genotype == 395]
data[data$plante_genotype == "395"]
data[data$plante_genotype=="395"]
data[data$plante_genotype="395"]
data[data$plante_genotype= ="395"]
data[data$plante_genotype==395]
View(data)
View(data)
data2<-data[-outlier,]
data2
View(data2)
data2<-data2[-c(419,149),]
data2<-data[-c(outlier,149,419),]
View(data2)
table(data2$plante_genotype,data2$voisin)
View(data2)
View(data2)
data2<-data[-149,]
data2<-data[-c(149,419),]
View(data2)
View(data)
View(data_final)
table(data_final$plante_genotype,data_final$voisin)
table(data2$plante_genotype,data2$voisin)
t(table(data2$plante_genotype,data2$voisin))
table(data$plante_genotype,data$plante_genotype)-t(table(data$plante_genotype,data$plante_genotype))
table(data$plante_genotype,data$voisin)-t(table(data$plante_genotype,data$voisin))
table(data2$plante_genotype,data2$voisin)-t(table(data2$plante_genotype,data2$voisin))
data2<-data %>%
filter(plante_genotype!=235 & voisin !=395)
View(data2)
data2<-data %>%
filter(plante_genotype!=235[voisin ==395])
data2<-data %>%
filter(plante_genotype!=395[voisin ==235])
data2<-data %>%
filter(plante_genotype[voisin ==235]!=395)
data2<-data %>%
filter(plante_genotype[voisin ==235]==395)
data2<-data %>%
filter(-plante_genotype[voisin ==235]==395)
data2<-data %>%
filter(plante_genotype[voisin ==235]=395)
data2<-data %>%
filter(-(plante_genotype!=235 & voisin !=395))
data2<-data %>%
filter(-(plante_genotype!="235" & voisin !="395"))
data2<-data %>%
filter((plante_genotype =="235" & voisin =="395"))
View(data2)
data2<-data %>%
filter(!(plante_genotype =="235" & voisin =="395"))
data2<-data %>%
filter(!(plante_genotype =="235" & voisin =="395"),
!(plante_genotype =="395" & voisin =="235"))
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data2)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data_final)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data)
spats_f <-SpATS(response = "Surface_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
mmod_rd_cov<- mmer(Longueur_feuille_2 ~
Structuration_design
+ poids_graine
+ Bloc_M,
random = ~
gvsr(plante_genotype,voisin)
+ vsr(C)
+ vsr(L)
+ spl2Da(Ligne,Colonne,nseg = c(1,5)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd_cov)
anova(mmod_rd_cov)
table(data$plante_genotype,data$voisin)-t(table(data$plante_genotype,data$voisin))*
)
table(data$plante_genotype,data$voisin)-t(table(data$plante_genotype,data$voisin))
table(data$plante_genotype,data$voisin)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = FALSE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ voisin + Structuration_design + Monoculture_Couple + poids_graine + Bloc_M,
random = ~  C + L,
data = data[-outlier,])
plot(spats_f)
mmod_rd<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ poids_graine,
random = ~
plante_genotype
+ voisin
+ vsr(plante_genotype:voisin)
+ spl2Da(Ligne,Colonne,nseg = c(10,10)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd)
anova(mmod_rd)
mmod_rd<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple,
random = ~
plante_genotype
+ voisin
+ vsr(plante_genotype:voisin)
+ spl2Da(Ligne,Colonne,nseg = c(10,10)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd)
anova(mmod_rd)
mmod_rd<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc
+ poids_graine
+ Monoculture_Couple
+ Condition_hydrique,
random = ~
plante_genotype
+ voisin
+ vsr(plante_genotype:voisin)
+ spl2Da(Ligne,Colonne,nseg = c(10,10)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd)
anova(mmod_rd)
warning()
warnings()
mod3 <- lm(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple
+ plante_genotype
* voisin,
data=data[-outlier,])
summary(mod3)
anova(mod3)
mmod_f<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ Monoculture_Couple
+ poids_graine
+ plante_genotype
+ voisin,
random = ~
spl2Da(Ligne,Colonne,nseg = c(1,5))
+ vsr(C)
+ vsr(L),
rcov = ~units,
data=data[-outlier,])
summary(mmod_f)
anova(mmod_f)
warnings()
mmod_rd<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple,
random = ~
plante_genotype
+ voisin
+ vsr(plante_genotype:voisin)
+ spl2Da(Ligne,Colonne,nseg = c(10,10)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd)
anova(mmod_rd)
spats_f <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M + Monoculture_Couple,
random = ~  C + L + voisin + plante_genotype:voisin,
data = data[-outlier,])
plot(spats_f)
getHeritability(spats_f)
spats_rd <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ SAP(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M + Monoculture_Couple,
random = ~  C + L + voisin + plante_genotype:voisin,
data = data[-outlier,])
getHeritability(spats_rd)
spats_rd <-SpATS(response = "Longueur_feuille_2" ,
genotype = "plante_genotype",
genotype.as.random = TRUE,
spatial = ~ PSANOVA(Colonne,Ligne,nseg = c(5,1)),
fixed = ~ Structuration_design + poids_graine + Bloc_M + Monoculture_Couple,
random = ~  C + L + voisin + plante_genotype:voisin,
data = data[-outlier,])
plot(spats_rd)
getHeritability(spats_rd)
AIC_BIC <- function (data,X){
A <- as.data.frame(matrix(ncol=5))
colnames(A)<-c("X","i","j","AIC","BIC")
df<-data %>%
dplyr::select("Structuration_design","poids_graine","plante_genotype","voisin","Bloc_M","Ligne","Colonne","L","C",X)
colnames(df)<-c("Structuration_design","poids_graine","plante_genotype","voisin","Bloc_M","Ligne","Colonne","L","C","X")
for (i in (1:18)){
for(j in (1:15)){
print(i)
print(j)
mod <- mmer(X ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple,
random = ~
plante_genotype
+ voisin
+ plante_genotype:voisin
+ spl2Da(Ligne,Colonne,nseg = c(i,j)),
rcov = ~units,
data=df)
B<-c(X,i,j,mod$AIC,mod$BIC)
A<-rbind(A,B)
}
}
return (A[-1,])
}
AIC_mmod_rd <- AIC_BIC(data[-outlier,],"Longueur_feuille_2")
AIC_BIC <- function (data,X){
A <- as.data.frame(matrix(ncol=5))
colnames(A)<-c("X","i","j","AIC","BIC")
df<-data %>%
dplyr::select("Structuration_design","Monoculture_Couple","poids_graine","plante_genotype","voisin","Bloc_M","Ligne","Colonne","L","C",X)
colnames(df)<-c("Structuration_design","Monoculture_Couple","poids_graine","plante_genotype","voisin","Bloc_M","Ligne","Colonne","L","C","X")
for (i in (1:18)){
for(j in (1:15)){
print(i)
print(j)
mod <- mmer(X ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple,
random = ~
plante_genotype
+ voisin
+ plante_genotype:voisin
+ C
+ L
+ spl2Da(Ligne,Colonne,nseg = c(i,j)),
rcov = ~units,
data=df)
B<-c(X,i,j,mod$AIC,mod$BIC)
A<-rbind(A,B)
}
}
return (A[-1,])
}
AIC_mmod_rd <- AIC_BIC(data[-outlier,],"Longueur_feuille_2")
mmod_rd<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple,
random = ~
plante_genotype
+ voisin
+ vsr(plante_genotype:voisin)
+ C
+ L
+ spl2Da(Ligne,Colonne,nseg = c(1,5)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd)
View(AIC_mmod_rd)
mmod_rd<- mmer(Longueur_feuille_2 ~
Structuration_design
+ Bloc_M
+ poids_graine
+ Monoculture_Couple,
random = ~
plante_genotype
+ voisin
+ vsr(plante_genotype:voisin)
+ spl2Da(Ligne,Colonne,nseg = c(1,5)),
rcov = ~units,
data=data[-outlier,])
summary(mmod_rd)
anova(mmod_rd)
install.packages("nlme")
install.packages("ape")
install.packages("MuMIn")
library(nlme)
library(ape)
library(MuMIn)
install.packages("nlme")
install.packages("nlme")
install.packages("nlme")
lmod<-lmer(masse_adv_reste ~ genotype + genotype_combinant + genotype:genotype_combinant + (1|planche_f)+ (1|passage_f),
correlation = corSpher(form = ~ X + Y, nugget = T),
data=data)
lmod<-lmer(masse_adv_reste ~ genotype + genotype_combinant + genotype:genotype_combinant + (1|planche_f)+ (1|passage_f),
correlation = corSpher(form = ~ planche + passage, nugget = F),
data=data)
lmod<-lmer(masse_adv_reste ~ genotype + genotype_combinant + genotype:genotype_combinant + (1|planche_f)+ (1|passage_f),
correlation = corSpher(form = ~ planche + passage, nugget = F),
data=data)
lmod<-lme(masse_adv_reste ~ genotype + genotype_combinant + genotype:genotype_combinant + (1|planche_f)+ (1|passage_f),
correlation = corSpher(form = ~ planche + passage, nugget = F),
data=data)
library(tidyverse)
library(sommer)
library(lmerTest)
library(SpATS)
library(plyr)
library(cowplot)
library(FactoMineR)
library(nlme)
library(ape)
library(MuMIn)
